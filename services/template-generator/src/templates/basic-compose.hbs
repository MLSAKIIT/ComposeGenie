version: '3.8'

services:
  {{#each services}}
  {{name}}:
    image: {{image}}
    {{#if ports}}
    ports:
      {{#each ports}}
      - "{{this}}"
      {{/each}}
    {{/if}}
    {{#if environment}}
    environment:
      {{#each environment}}
      - {{key}}={{value}}
      {{/each}}
    {{/if}}
    {{#if volumes}}
    volumes:
      {{#each volumes}}
      - {{this}}
      {{/each}}
    {{/if}}
  {{/each}}

{{#if networks}}
networks:
  {{#each networks}}
  {{name}}:
    driver: {{driver}}
  {{/each}}
{{/if}}

{{#if volumes}}
volumes:
  {{#each volumes}}
  {{name}}:
    driver: {{driver}}
  {{/each}}
{{/if}}